{% extends "base.html" %}

{% block title %}Gallery{% endblock %}

{% block content %}
    <h1>Captured Images</h1>
    <div class="gallery" id="gallery"></div>
    <div class="nav-buttons">
        <button onclick="prevImage()">&#9665; Previous</button>
        <button onclick="nextImage()">Next &#9655;</button>
    </div>
    <a href="/" class="back-link">Back to Home</a>

    <script>
        let images = [];
        let currentIndex = 0;

        function loadImages() {
            fetch("/captured_images")
                .then(response => response.json())
                .then(data => {
                    images = data.images;
                    displayImage();
                })
                .catch(error => console.error("Error fetching images:", error));
        }

        function displayImage() {
            const gallery = document.getElementById("gallery");
            gallery.innerHTML = "";
            if (images.length > 0) {
                let img = document.createElement("img");
                img.src = images[currentIndex];
                img.classList.add("active");
                gallery.appendChild(img);

                let filename = document.createElement("p");
                filename.textContent = "Filename: " + images[currentIndex].split('/').pop(); // To display only the filename
                gallery.appendChild(filename);
            }
        }

        function prevImage() {
            if (images.length > 0) {
                currentIndex = (currentIndex - 1 + images.length) % images.length;
                displayImage();
            }
        }

        function nextImage() {
            if (images.length > 0) {
                currentIndex = (currentIndex + 1) % images.length;
                displayImage();
            }
        }

        loadImages();
    </script>
{% endblock %}
